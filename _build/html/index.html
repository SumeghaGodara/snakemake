

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  
  <!-- Licensed under the Apache 2.0 License -->
  <link rel="stylesheet" type="text/css" href="_static/fonts/open-sans/stylesheet.css" />
  <!-- Licensed under the SIL Open Font License -->
  <link rel="stylesheet" type="text/css" href="_static/fonts/source-serif-pro/source-serif-pro.css" />
  <link rel="stylesheet" type="text/css" href="_static/css/bootstrap.min.css" />
  <link rel="stylesheet" type="text/css" href="_static/css/bootstrap-theme.min.css" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
    <title>1. Reproducible Workflows using Snakemake and Singularity &#8212; snakemake2019 0.0.1 documentation</title>
    <link rel="stylesheet" href="_static/guzzle.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="8. Introduction" href="introduction.html" />
    <link rel="prev" title="&lt;no title&gt;" href="toc.html" />
  
   

  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="introduction.html" title="8. Introduction"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="toc.html" title="&lt;no title&gt;"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="toc.html">snakemake2019 0.0.1 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="container-wrapper">

      <div id="mobile-toggle">
        <a href="#"><span class="glyphicon glyphicon-align-justify" aria-hidden="true"></span></a>
      </div>
  <div id="left-column">
    <div class="sphinxsidebar">
<div class="sidebar-block">
  <div class="sidebar-wrapper">
    <h2>Contents</h2>
    <div class="sidebar-localtoc">
      <ul>
<li><a class="reference internal" href="#">1. Reproducible Workflows using Snakemake and Singularity</a><ul>
<li><a class="reference internal" href="#author">1.1. Author:</a></li>
<li><a class="reference internal" href="#credits">1.2. Credits</a></li>
</ul>
</li>
<li><a class="reference internal" href="#learning-objectives">2. Learning Objectives</a></li>
<li><a class="reference internal" href="#introduction">3. Introduction</a></li>
<li><a class="reference internal" href="#working-on-binder">4. Working on Binder</a></li>
<li><a class="reference internal" href="#working-on-cloud">5. Working on Cloud</a></li>
<li><a class="reference internal" href="#custom-install">6. Custom Install</a></li>
<li><a class="reference internal" href="#awesome">7. Awesome</a></li>
</ul>

    </div>
  </div>
</div>
  <h4>Previous topic</h4>
  <p class="topless"><a href="toc.html"
                        title="previous chapter">&lt;no title&gt;</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="introduction.html"
                        title="next chapter">8. Introduction</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/index.md.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div class="sidebar-block">
  <div class="sidebar-wrapper">
    <div id="main-search">
      <form class="form-inline" action="search.html" method="GET" role="form">
        <div class="input-group">
          <input name="q" type="text" class="form-control" placeholder="Search...">
        </div>
        <input type="hidden" name="check_keywords" value="yes" />
        <input type="hidden" name="area" value="default" />
      </form>
    </div>
  </div>
</div>
      
    </div>
  </div>
        <div id="right-column">
          
          <div role="navigation" aria-label="breadcrumbs navigation">
            <ol class="breadcrumb">
              <li><a href="toc.html">Docs</a></li>
              
              <li>1. Reproducible Workflows using Snakemake and Singularity</li>
            </ol>
          </div>
          
          <div class="document clearer body">
            
  <div class="section" id="reproducible-workflows-using-snakemake-and-singularity">
<h1>1. Reproducible Workflows using Snakemake and Singularity<a class="headerlink" href="#reproducible-workflows-using-snakemake-and-singularity" title="Permalink to this headline">¶</a></h1>
<p><img alt="_images/tutorial_logo.png" src="_images/tutorial_logo.png" />logo</p>
<ul class="simple">
<li><strong>The Snakemake workflow management system is a tool to create reproducible and scalable data analyses.</strong></li>
<li><strong>Workflows are described via a human readable, Python based language. They can be seamlessly scaled to server, cluster, grid and cloud environments, without the need to modify the workflow definition.</strong></li>
<li><strong>Snakemake workflows can entail a description of required software, which will be automatically deployed to any execution environment.</strong></li>
</ul>
<blockquote>
<div>Basic UNIX command-line experience required.</div></blockquote>
<blockquote>
<div>You don’t need to be an expert at Python to use Snakemake, but it can sometimes be very useful.</div></blockquote>
<blockquote>
<div>No license; the below content is available under CC0 general license.</div></blockquote>
<div class="section" id="author">
<h2>1.1. Author:<a class="headerlink" href="#author" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><a class="reference external" href="https://twitter.com/perisateesh">Sateesh Peri</a></div></blockquote>
</div>
<div class="section" id="credits">
<h2>1.2. Credits<a class="headerlink" href="#credits" title="Permalink to this headline">¶</a></h2>
<p>The content for this website has been compiled from tutorials put together by:</p>
<ul class="simple">
<li><a class="reference external" href="https://twitter.com/ctitusbrown">Titus Brown</a> - Link to <a class="reference external" href="https://github.com/ctb/2019-snakemake-ucdavis">Tutorial</a></li>
<li><a class="reference external" href="https://twitter.com/johanneskoester">Johannes Koster</a> - Link to <a class="reference external" href="https://snakemake.readthedocs.io/en/stable/tutorial/tutorial.html">Tutorial</a></li>
<li><a class="reference external" href="https://www.cyverse.org/about">CyVerse</a></li>
</ul>
</div>
</div>
<div class="section" id="learning-objectives">
<h1>2. Learning Objectives<a class="headerlink" href="#learning-objectives" title="Permalink to this headline">¶</a></h1>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">+</span> <span class="n">Understand</span> <span class="n">snakemake</span> <span class="n">syntax</span>
<span class="o">+</span> <span class="n">Understand</span> <span class="n">the</span> <span class="n">idea</span> <span class="n">of</span> <span class="n">containers</span>
<span class="o">+</span>
</pre></div>
</div>
<ul class="simple">
<li>This tutorial is designed to introduce ‘building reproducible workflows’ using:<ul>
<li><a class="reference external" href="https://conda.io/en/latest/"><strong>conda</strong></a> and <a class="reference external" href="https://bioconda.github.io/"><strong>bioconda</strong></a> for <strong>Environment Management</strong></li>
<li><a class="reference external" href="https://snakemake.readthedocs.io/en/stable/"><strong>Snakemake</strong></a> for <strong>Workflow Management</strong></li>
<li><a class="reference external" href="https://www.sylabs.io/docs/"><strong>Singularity</strong></a> for <strong>Container Management</strong></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="introduction">
<h1>3. <a class="reference external" href="https://snakemake2019.readthedocs.io/en/latest/introduction.html">Introduction</a><a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h1>
</div>
<div class="section" id="working-on-binder">
<h1>4. Working on Binder<a class="headerlink" href="#working-on-binder" title="Permalink to this headline">¶</a></h1>
<blockquote>
<div>Note:  No support for ‘–use-singularity’</div></blockquote>
<ul class="simple">
<li>We’re going to use <a class="reference external" href="https://mybinder.org/">mybinder.org</a>, a fantastic service that lets us run demonstrations and short workshops in the cloud!</li>
</ul>
<blockquote>
<div><strong>Click on this <a class="reference external" href="https://mybinder.org/v2/gh/sateeshperi/snakemake2019.git/binder?urlpath=rstudio"><img alt="https://mybinder.org/badge_logo.svg" src="https://mybinder.org/badge_logo.svg" />Binder</a> button to launch a pre-configured Binder file that is rendered via a Rstudio interface.</strong></div></blockquote>
<ul class="simple">
<li>The binder is built using this ‘conda’ <a class="reference external" href="https://github.com/sateeshperi/snakemake2019/blob/master/binder/environment.yml">environment.yml</a>.</li>
</ul>
<blockquote>
<div><a class="reference external" href="https://snakemake2019.readthedocs.io/en/latest/basic_tutorial.html"><strong>Basic Tutorial using Binder</strong></a></div></blockquote>
</div>
<div class="section" id="working-on-cloud">
<h1>5. Working on Cloud<a class="headerlink" href="#working-on-cloud" title="Permalink to this headline">¶</a></h1>
<blockquote>
<div>Support for ‘–use-singularity’ (shub://) &amp; (docker://) containers</div></blockquote>
<ul class="simple">
<li>To run snakemake jobs via <a class="reference external" href="#">Singularity</a> / <a class="reference external" href="#">Docker</a> containers in the cloud, we recommend <a class="reference external" href="https://www.cyverse.org/atmosphere"><strong>Atmosphere</strong></a>, CyVerse’s cloud-computing platform which provides easy-to-use web-access to cloud resources and is designed to accommodate computationally and data-intensive tasks.</li>
</ul>
<blockquote>
<div><a class="reference external" href="https://user.cyverse.org/register"><strong>1. Register for a free account on CyVerse</strong></a></div></blockquote>
<blockquote>
<div><a class="reference external" href="https://snakemake2019.readthedocs.io/en/latest/Atmosphere_Cloud.html"><strong>2. Guide to Launching Atmosphere Instances</strong></a></div></blockquote>
<blockquote>
<div><a class="reference external" href="https://snakemake2019.readthedocs.io/en/latest/container_tutorial.html"><strong>3. Container Tutorial using Atmosphere</strong></a></div></blockquote>
<ul class="simple">
<li><em>Atmosphere Key Features:</em><ul>
<li>Access virtual machine images preconfigured with an operating system and software to help you do scientific computations in domain-specific tasks</li>
<li>Find and use tools with the intuitive self-service portal</li>
<li>Easily manage virtual machines</li>
<li>Publish your own software suites, create your own work environments, and run the software for community use</li>
<li>Access your data in the Data Store, including high-performance computing (HPC) and grid computing environments</li>
<li>Integrate with existing infrastructure components using API services</li>
<li>Easily generate and manage statistical reporting of user resources for total CPU hours and memory usages, total instances and applications launched by user, cloud monitoring, and on-demand intelligence resource allocation</li>
</ul>
</li>
</ul>
<blockquote>
<div><img alt="_images/cyverse_logo.png" src="_images/cyverse_logo.png" />cyverse_logo <strong><a class="reference external" href="https://www.cyverse.org/about"><strong>CyVerse</strong></a> is a cyber-infrastructure initiative funded by the National Science Foundation’s Directorate for Biological Sciences to address the growing needs for highly configurable and customized computational infrastructure to support research efforts in data sciences.</strong>
<img alt="_images/cyverse_services.png" src="_images/cyverse_services.png" />cyverse_services</div></blockquote>
</div>
<div class="section" id="custom-install">
<h1>6. Custom Install<a class="headerlink" href="#custom-install" title="Permalink to this headline">¶</a></h1>
<blockquote>
<div>We recommend <a class="reference external" href="https://conda.io/en/latest/"><strong>conda</strong></a>, an open source package management system and environment management system that runs on Windows, macOS and Linux.</div></blockquote>
<ul class="simple">
<li>Download and install conda:</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">O</span> <span class="o">-</span><span class="n">L</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">repo</span><span class="o">.</span><span class="n">continuum</span><span class="o">.</span><span class="n">io</span><span class="o">/</span><span class="n">miniconda</span><span class="o">/</span><span class="n">Miniconda3</span><span class="o">-</span><span class="n">latest</span><span class="o">-</span><span class="n">Linux</span><span class="o">-</span><span class="n">x86_64</span><span class="o">.</span><span class="n">sh</span>
<span class="n">bash</span> <span class="n">Miniconda3</span><span class="o">-</span><span class="n">latest</span><span class="o">-</span><span class="n">Linux</span><span class="o">-</span><span class="n">x86_64</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
<blockquote>
<div>Say “yes” to everything the installer asks, and accept default locations by pressing enter when it says “Miniconda3 will now be installed into this location”. (If the prompt looks like this “&gt;&gt;&gt;”, then you are still within the installation process.)</div></blockquote>
<ul class="simple">
<li>When the installation is complete and the regular prompt returns, run the following command (or start a new terminal session) in order to activate the conda environment:</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">source</span> <span class="o">~/.</span><span class="n">bashrc</span>
</pre></div>
</div>
<ul class="simple">
<li>Next, enable various “channels” for software install, including bioconda:</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">conda</span> <span class="n">config</span> <span class="o">--</span><span class="n">add</span> <span class="n">channels</span> <span class="n">defaults</span>
<span class="n">conda</span> <span class="n">config</span> <span class="o">--</span><span class="n">add</span> <span class="n">channels</span> <span class="n">conda</span><span class="o">-</span><span class="n">forge</span>
<span class="n">conda</span> <span class="n">config</span> <span class="o">--</span><span class="n">add</span> <span class="n">channels</span> <span class="n">bioconda</span>
</pre></div>
</div>
<ul class="simple">
<li>Next, download conda ‘environment.yml’ file, designed for this tutorial <a class="reference external" href="https://github.com/sateeshperi/snakemake2019/blob/master/binder/environment.yml">here</a></li>
<li>Install tools in a new conda environment ‘smake’ using downloaded environemnt file</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">conda</span> <span class="n">env</span> <span class="n">create</span> <span class="o">--</span><span class="n">file</span> <span class="n">environment</span><span class="o">.</span><span class="n">yml</span> <span class="o">-</span><span class="n">n</span> <span class="n">smake</span>
</pre></div>
</div>
<ul class="simple">
<li>To activate the environment for tutorial</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">conda</span> <span class="n">activate</span> <span class="n">smake</span>
</pre></div>
</div>
<ul class="simple">
<li>To deactivate environment after use</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">conda</span> <span class="n">deactivate</span>
</pre></div>
</div>
<blockquote>
<div>To run jobs in containers:</div></blockquote>
<ul class="simple">
<li>Singularity installation needs <strong>sudo</strong> permissions and instructions can be found <a class="reference external" href="https://www.sylabs.io/guides/3.0/user-guide/installation.html#installation">here</a></li>
</ul>
<blockquote>
<div>Singularity modules in HPCs</div></blockquote>
</div>
<div class="section" id="awesome">
<h1>7. <a class="reference external" href="https://snakemake2019.readthedocs.io/en/latest/awesome.html">Awesome</a><a class="headerlink" href="#awesome" title="Permalink to this headline">¶</a></h1>
</div>


          </div>
            
  <div class="footer-relations">
    
      <div class="pull-left">
        <a class="btn btn-default" href="toc.html" title="previous chapter (use the left arrow)">&lt;no title&gt;</a>
      </div>
    
      <div class="pull-right">
        <a class="btn btn-default" href="introduction.html" title="next chapter (use the right arrow)">8. Introduction</a>
      </div>
    </div>
    <div class="clearer"></div>
  
        </div>
        <div class="clearfix"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="introduction.html" title="8. Introduction"
             >next</a> |</li>
        <li class="right" >
          <a href="toc.html" title="&lt;no title&gt;"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="toc.html">snakemake2019 0.0.1 documentation</a> &#187;</li> 
      </ul>
    </div>
<script type="text/javascript">
  $("#mobile-toggle a").click(function () {
    $("#left-column").toggle();
  });
</script>
<script type="text/javascript" src="_static/js/bootstrap.js"></script>
  <div class="footer">
    &copy; Copyright 2019, Sateesh Peri. Created using <a href="http://sphinx.pocoo.org/">Sphinx</a>.
  </div>
  </body>
</html>